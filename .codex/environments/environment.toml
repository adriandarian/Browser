# THIS IS AUTOGENERATED. DO NOT EDIT MANUALLY
version = 1
name = "Browser"

[setup]
script = '''
set -euo pipefail

echo "[setup] Browser project setup"

if ! command -v rustup >/dev/null 2>&1; then
  echo "[setup] rustup not found. Install from https://rustup.rs" >&2
  exit 1
fi

rustup toolchain install stable >/dev/null 2>&1 || true

if ! command -v python3 >/dev/null 2>&1; then
  echo "[setup] python3 not found. Install Python 3.11+" >&2
  exit 1
fi

if ! command -v just >/dev/null 2>&1; then
  echo "[setup] installing just via cargo"
  cargo install just || true
fi

echo "[setup] done"
'''

[[actions]]
name = "Build"
icon = "tool"
command = "just build"

[[actions]]
name = "Run (macOS)"
icon = "run"
command = "bash --noprofile --norc -lc 'python3 tools/py/run.py run'"

[[actions]]
name = "Run (Windows)"
icon = "run"
command = "bash --noprofile --norc -lc 'python tools/py/run.py run'"

[[actions]]
name = "Test"
icon = "test"
command = "just test"

[[actions]]
name = "Golden"
icon = "debug"
command = "just golden"

[[actions]]
name = "Fmt"
icon = "tool"
command = "just fmt"

[[actions]]
name = "IPC Schema"
icon = "debug"
command = "bash --noprofile --norc -lc 'python3 tools/py/ipc_codegen.py'"

[[actions]]
name = "macOS Setup"
icon = "tool"
command = """bash --noprofile --norc -lc '
if ! command -v zig >/dev/null 2>&1; then
  if command -v brew >/dev/null 2>&1; then
    brew install zig
  else
    echo \"Install Zig 0.12+ manually\"
    exit 1
  fi
fi
cargo test --workspace
python3 tools/py/run.py test --update || true
'"""

[[actions]]
name = "Windows Setup"
icon = "tool"
command = """bash --noprofile --norc -lc '
if command -v winget >/dev/null 2>&1; then
  winget install -e --id Zig.Zig || true
fi
cargo test --workspace
python tools/py/run.py test --update || true
'"""
